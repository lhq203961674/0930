■ SFTP と MQ におけるデータ管理方式の違い

SFTP はファイル転送方式であり、送信対象となるダミーファイルはファイルシステム上の実体として残存する。そのため、送信完了および受信確認後に、不要なファイルを明示的に削除する運用が求められる。一方、MQ はメッセージキュー方式であり、電文は受信処理が完了した時点で自動的にキューから消費されるため、削除作業は不要であり、CURDEPTH による滞留有無の確認が重要となる。

⸻

■ sftpput.sh による SFTP 共通部品の役割

sftpput.sh は SFTP による put 処理を共通化した汎用スクリプトであり、接続先ホスト、ポート番号、接続ユーザ、SSH 鍵、ローカルファイル、リモートディレクトリを引数として受け取る設計となっている。共通設定ファイルや共通関数を参照し、ログ出力やエラーハンドリングを含めた標準的な転送処理を一元的に担う部品である。

⸻

■ sftp_send.sh による作業単位の制御設計

sftp_send.sh は本作業専用のラッパースクリプトとして作成され、CHN・EPA・HKG 各据点向けの sftpput.sh 呼び出しを集約する役割を持つ。個別の転送条件を作業単位で明示的に定義することで、作業手順の簡素化および人的ミスの防止を図る構成となっている。

⸻

■ 共通部品と作業用スクリプト分離の設計意図

SFTP 処理を共通部品と作業用スクリプトに分離することで、再利用性と保守性が向上する。特に本番環境では、共通部品に手を加えず、作業影響範囲を限定できる点が重要であり、レビューや障害発生時の切り分けも容易となる。

⸻

■ DRLiveRun における事前準備の本番特有要件

本番環境での DRLiveRun では、hosts 切替は作業者ではなく運用部により事前に実施される前提となる。そのため、作業手順書上は切替作業そのものを記載せず、「切替済みであること」を前提条件として明確に定義する必要がある。

⸻

■ 実送信を伴う疎通確認作業の位置付け

本作業では、単なるネットワーク疎通確認に留まらず、実際の SFTP ファイル転送および MQ 電文送受信を通じて、外部システムとのインターフェースが設計通りに動作することを確認する。送信、受信、滞留確認、後片付けまでを含めた一連の流れを作業として設計することが、運用品質確保の観点で重要となる。
